var infoWindow=new google.maps.InfoWindow({content:infoWindowNode}),ViewModel=function(){var self=this;this.locations=[],function(){locationData.forEach(function(location){self.locations.push(location)})}(),this.locationList=ko.observableArray(this.locations),this.locationData=ko.observableArray(locationData),this.markerList=ko.observableArray([allMarkers]),this.query=ko.observable(""),this.search=function(value){allMarkers.forEach(function(marker){marker.setMap(null)});for(var x in allMarkers)allMarkers[x].title.toLowerCase().indexOf(value.toLowerCase())>=0&&allMarkers[x].setMap(map);for(var listItemsList=document.getElementsByClassName("listItem"),i=0;i<listItemsList.length;i++)listItemsList[i].style.display="none";for(var i in listItemsList)(locationData[i].type.toLowerCase().indexOf(value.toLowerCase())>=0||listItemsList[i].textContent.toLowerCase().indexOf(value.toLowerCase())>=0)&&(listItemsList[i].style.display="flex")},this.query.subscribe(self.search),this.infoWindowName=document.createElement("h1"),this.infoWindowName.id="infoWindowName",this.infoWindowNode=document.getElementById("infoWindowNode"),this.openNav=function(){document.getElementById("listContainer").style="left: 0",document.getElementById("mapContainer").style="transition: 1s; left: 135px"},this.closeNav=function(){document.getElementById("listContainer").style="left: -230px",document.getElementById("mapContainer").style="transition: .25s; left: 0px"},this.closeNavOnSelect=function(){$(window).width()<768&&self.closeNav()},this.openInfoWindow=function(index){function getFourSquare(){var venueID=locationData[index].foursquareVenueID;$.ajax({dataType:"jsonp",url:"https://api.foursquare.com/v2/venues/"+venueID+"?client_id=2DV1P3YPGYBLCEXLTRGNBKZR2EHZINKEHVET2TCUFQFQ23KS&client_secret=EFDTVXXZJSBEVC12RAMZBV24RFUDEY3E1CG2USRDT0NWEK1A&v=20170101&m=foursquare"}).done(function(data){if(console.log(data),"venue"in data.response){var venueInfo=data.response.venue,photoGrab=data.response.venue.photos.groups[0].items[0];$("#foursquareLocation, #foursquareLink, #foursquareImg, #foursquareError").remove(),$("#infoWindowNode").append("<h2 id='foursquareLocation'>"+venueInfo.location.address+" "+venueInfo.location.city+", "+venueInfo.location.state+"</h2>"),$("#infoWindowNode").append("<a target='_blank' id='foursquareLink' class='foursquareLink' href='"+venueInfo.url+"'>Visit Website</a>"),$("#infoWindowNode").append("<img id='foursquareImg' class='infoWindowImg' src='"+photoGrab.prefix+photoGrab.width+"x"+photoGrab.height+photoGrab.suffix+"'>")}else $("#foursquareLocation, #foursquareLink, #foursquareImg, #foursquareError").remove(),$("#infoWindowNode").append("<h3 id='foursquareError'>Sorry! Foursquare data could not be found for this location.")}).fail(function(){$("#foursquareLocation, #foursquareLink, #foursquareImg").remove(),$("#infoWindowNode").append("<h3>Foursquare could not be reached at this time.</h3>")})}function getWiki(){var wikiURL="https://en.wikipedia.org/w/api.php?action=query&titles="+listItemName+"&prop=revisions&rvprop=content&format=json",wikiRequestTimeout=setTimeout(function(){$("#infoWindowNode").append("<h3 id='wikiTitle'>Failed to get WikiPedia sources.</h3>")},5e3);$.ajax({dataType:"jsonp",url:wikiURL}).done(function(data){console.log(data);var wikiObject=data.query.pages[Object.keys(data.query.pages)[0]],wikiTitle=wikiObject.title;$("#wikiTitle").remove(),"missing"in wikiObject?$("#infoWindowNode").append("<h3 id='wikiTitle'>Sorry; there are no WikiPedia articles for this location.</h3>"):$("#infoWindowNode").append("<h3 id='wikiTitle'>Read All About: <a target=_blank href='https://en.wikipedia.org/wiki/"+wikiTitle+"'>"+wikiTitle+"</a>!</h3>"),clearTimeout(wikiRequestTimeout)}).fail(function(data){alert("Failed to get WikiPedia resources.")})}$("#infoWindowName").remove();var listItemIndex=index,listItemName=locationData[listItemIndex].name;self.infoWindowName.textContent=listItemName,self.infoWindowNode.appendChild(self.infoWindowName),infoWindow.open(map,allMarkers[listItemIndex]),getFourSquare(),getWiki(),null!==allMarkers[listItemIndex].getAnimation()?allMarkers[listItemIndex].setAnimation(null):(allMarkers[listItemIndex].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){allMarkers[listItemIndex].setAnimation(null)},750))}};ko.applyBindings(new ViewModel);